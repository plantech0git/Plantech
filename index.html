<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <title>Land/Provincie Kaart</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.js"></script>
    <style>
        #map { 
            height: 100vh; 
            width: 100%; 
            margin: 0;
            padding: 0;
        }
    </style>
</head>
<body>
    <div id="map"></div>

    <script>
        // Centrale coördinaten voor landen (basis geografische centra)
        const countryCenters = {
            "China": [35.8617, 104.1954],
            "Japan": [36.2048, 138.2529],
            "United States": [37.0902, -95.7129],
            "India": [20.5937, 78.9629],
            "Russia": [61.5240, 105.3188],
            "Brazil": [-14.2350, -51.9253],
            "Australia": [-25.2744, 133.7751],
            "Canada": [56.1304, -106.3468],
            "Germany": [51.1657, 10.4515],
            "France": [46.2276, 2.2137],
            // Voeg meer landen toe zoals nodig
        };

        function initLocationMap(data) {
            // Verwijder bestaande kaart indien aanwezig
            if (window.mapInstance) {
                window.mapInstance.remove();
            }

            // Zoek de coördinaten voor het land
            let center = countryCenters[data.country] || [0, 0];
            let zoomLevel = data.zoomLevel || 5;

            // Kaart initialiseren 
            window.mapInstance = L.map('map').setView(center, zoomLevel);

            // Basis kaartlaag toevoegen
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '© OpenStreetMap contributors'
            }).addTo(window.mapInstance);

            // Markeer het land
            L.marker(center)
                .addTo(window.mapInstance)
                .bindPopup(data.country || 'Geselecteerde locatie')
                .openPopup();
        }

        // Luister naar POST requests
        window.addEventListener('message', function(event) {
            try {
                const data = event.data;
                
                // Valideer de data
                if (data.country) {
                    initLocationMap(data);
                }
            } catch (error) {
                console.error('Fout bij verwerken locatiedata:', error);
            }
        }, false);

        // Stuurt een bericht terug dat de kaart gereed is
        window.parent.postMessage({ status: 'ready' }, '*');
    </script>
</body>
</html>
